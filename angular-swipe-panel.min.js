/*
 angular-swipe-panel v0.1
 (c) 2014 Tim RÃ¼cker
 License: Apache License
*/
(function(b){b.angular.module("angular-swipe-panel",[]).factory("nano_allPanels",function(){return{}}).factory("swipePanelConfigs",[function(){return{XRegisterDistance:25,YIgnoreDistance:8,panelWidth:80,toggleDistance:75,swipeOpen:!1}}]).constant("nano_swipePanelConst",new function(){this.W3CTouch="ontouchstart"in b&&"ontouchmove"in b&&"ontouchend"in b&&"ontouchcancel"in b;this.isMSTouch="onmspointerdown"in b&&"onmspointermove"in b&&"onmspointerup"in b&&"onmspointerover"in b&&"onmspointerout"in b;
    this.touchStart=this.W3CTouch?"touchstart":this.isMSTouch?"MSPointerDown":"mousedown";this.touchEnd=this.W3CTouch?"touchend":this.isMSTouch?"MSPointerUp":"mouseup";this.touchMove=this.W3CTouch?"touchmove":this.isMSTouch?"MSPointerMove":"mousemove"}).run(["swipePanelConfigs","nano_swipePanelConst","nano_allPanels","panelActions",function(c,g,d,h){function k(){a.coordsX.min=Math.min.apply(null,a.touchesX);a.coordsX.max=Math.max.apply(null,a.touchesX);a.coordsY.min=Math.min.apply(null,a.touchesY);a.coordsY.max=
    Math.max.apply(null,a.touchesY);var f=a.coordsX.max-a.coordsX.min,k=a.coordsY.max-a.coordsY.min;k>=b.innerHeight/100*c.YIgnoreDistance||k>f||5>a.touchesX.length&&f<b.innerWidth/100*c.XRegisterDistance||(f=a.touchesX[0]<a.touchesX[a.touchesX.length-1],a.direction=f?"right":"left",a.oppositeDirection=f?"left":"right")}var a={touchesX:[],touchesY:[],coordsX:{min:0,max:0},coordsY:{min:0,max:0},direction:"",diff:0,oppositeDirection:""},e={touchStart:function(c){a.touchesX.push(g.W3CTouch?c.touches[0].screenX:
    c.clientX);a.touchesY.push(b.scrollY);b.addEventListener(g.touchMove,e.touchMove,!1)},touchEnd:function(f){b.removeEventListener(g.touchMove,e.touchMove);a.touchesX.push(g.W3CTouch?f.changedTouches[0].screenX:f.clientX);a.touchesY.push(b.scrollY);""===a.direction&&k();if(""!==a.direction)if(d[a.direction].isOpen)d[a.direction].close();else d[a.oppositeDirection][a.coordsX.max-a.coordsX.min>=c.toggleDistance?"open":"close"]();a.touchesX.length=0;a.coordsX.min=0;a.coordsX.max=0;a.touchesY.length=0;
    a.coordsY.min=0;a.coordsY.max=0;a.direction="";a.oppositeDirection=""},touchMove:function(f){var e=g.W3CTouch?f.touches[0].screenX:f.clientX;a.touchesX.length<2*c.XRegisterDistance&&(a.touchesX.push(e),a.touchesY.push(b.scrollY));a.touchesX.length<c.XRegisterDistance||(a.touchesX.length===c.XRegisterDistance&&k(),""===a.direction||d[a.direction].isOpen||(d[a.oppositeDirection].newX="left"===a.oppositeDirection?e-b.innerWidth/100*c.panelWidth-d[a.oppositeDirection].parentMargin:e-d[a.oppositeDirection].parentMargin,
    e="left"===a.direction&&0>=d[a.oppositeDirection].newX+d[a.oppositeDirection].parentMargin-b.innerWidth/100*(100-c.panelWidth),e="right"===a.direction&&0<=d[a.oppositeDirection].newX+d[a.oppositeDirection].parentMargin||e?!0:!1,e||(f.preventDefault(),f={"transition-duration":"0s"},f[d[a.oppositeDirection].cssProps.transform]="translate3d("+d[a.oppositeDirection].newX+"px, 0px,0px)",d[a.oppositeDirection].element.css(f))))}};c.swipeOpen&&(b.addEventListener(g.touchStart,e.touchStart,!1),b.addEventListener(g.touchEnd,
    e.touchEnd,!1));b.addEventListener("resize",h.resize,!1)}]).factory("panelActions",["nano_allPanels","$rootScope",function(c,b){function d(b){return"string"===typeof b&&"undefined"!==typeof c[b]}var h={resize:function(){for(var b in c)c[b].resize&&c[b].resize()},toggle:function(b){c.hider.css("display","none");if("string"===typeof b&&"undefined"!==typeof c[b])return c[b].toggle();for(var a in c)if(c[a].isOpen)return c[a].toggle();return!1},open:function(b){if(!d(b)&&!c[b].isOpen)return!1;c.hider.css("display",
    "block");return c[b].open()},close:function(b){if(!d(b)&&c[b].isOpen)return!1;c.hider.css("display","none");return c[b].close()}};return b.panelActions=h}]).factory("nano_panelCreator",["$window","$rootScope","swipePanelConfigs",function(c,g,d){return function(h,k){var a=this;this.position=k;this.element=h;this.isOpen=!1;this.parentMargin=(b.innerWidth-this.element.parent()[0].offsetWidth)/2;this.resize=function(c){this.width=b.innerWidth/100*d.panelWidth;this.startX=("left"===this.position?0-this.width:
    b.innerWidth)-this.parentMargin;this.stopX=("left"===this.position?0:b.innerWidth/100*(100-d.panelWidth))-this.parentMargin;var e={width:this.width+"px","transition-duration":"0s"};this.element.parent().css({width:b.innerWidth+"px"});this.element.css(e);c&&g.$apply(function(){a.close(!0)})};this.resize();angular.element(c).bind("resize",function(){a.resize(!0)});var e=b.document.body.style;this.cssProps="MozTransition"in e&&"MozTransform"in e?{domTransition:"MozTransition",transition:"-moz-transition",
    transform:"-moz-transform",domTransform:"MozTransform",radialGradient:"-moz-radial-gradient",repeatingLinearGradient:"-moz-repeating-linear-gradient",translate3d:"translate3d",userSelect:"-moz-user-select"}:"WebkitTransition"in e&&"WebkitTransform"in e?{domTransition:"WebkitTransition",transition:"-webkit-transition",transform:"-webkit-transform",domTransform:"WebkitTransform",radialGradient:"-webkit-radial-gradient",repeatingLinearGradient:"-webkit-repeating-linear-gradient",translate3d:"translate3d",
    userSelect:"-webkit-user-select"}:"msTransition"in e&&"msTransform"in e?{domTransition:"msTransition",transition:"-ms-transition",transform:"-ms-transform",domTransform:"msTransform",radialGradient:"-ms-radial-gradient",repeatingLinearGradient:"-ms-repeating-linear-gradient",translate3d:"translate3d",userSelect:"-ms-user-select"}:{domTransition:"transition",transition:"transition",transform:"transform",domTransform:"transform",radialGradient:"radial-gradient",repeatingLinearGradient:"repeating-linear-gradient",
    translate3d:"translate3d",userSelect:"user-select"};this.toggle=function(){this[this.isOpen?"close":"open"]()};this.open=function(){this.isOpen=!0;var a={"transition-duration":"0.3s"};a[this.cssProps.transform]="translate3d("+this.stopX+"px, 0px,0px)";this.element.css(a)};this.close=function(a){this.isOpen=!1;a={"transition-duration":a?"0s":"0.3s"};a[this.cssProps.transform]="translate3d("+this.startX+"px, 0px,0px)";this.element.css(a)};this.element.parent().css({width:b.innerWidth+"px"});e={position:"fixed",
    top:"0px","z-index":"9999",width:this.width+"px",height:"150%","transition-timing-function":"ease-in-out"};e[this.cssProps.transform]="translate3d("+this.startX+"px, 0px,0px)";this.element.css(e)}}]).directive("ngSwipePanel",["nano_panelCreator","nano_allPanels",function(b,g){return{compile:function(d,h){var k=h.ngSwipePanel;"undefined"===typeof g[k]&&(g[k]=new b(d,k))}}}]).directive("ngSwipePanelHider",["$rootScope","nano_allPanels","panelActions",function(b,g,d){return{compile:function(h){h.css({display:"none",
    width:"100%",height:"100%",position:"fixed","z-index":9998});g.hider=h;h.on("click",function(){b.$apply(function(){d.toggle()})})}}}])})(window);