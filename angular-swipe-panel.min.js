/*
 angular-swipe-panel v0.1
 (c) 2014 Tim RÃ¼cker
 License: Apache License
*/
(function(b){b.angular.module("angular-swipe-panel",[]).factory("nano_allPanels",function(){return{}}).factory("swipePanelConfigs",[function(){return{XRegisterDistance:25,YIgnoreDistance:8,panelWidth:80,toggleDistance:75,swipeOpen:!1}}]).constant("nano_swipePanelConst",new function(){this.W3CTouch="ontouchstart"in b&&"ontouchmove"in b&&"ontouchend"in b&&"ontouchcancel"in b;this.isMSTouch="onmspointerdown"in b&&"onmspointermove"in b&&"onmspointerup"in b&&"onmspointerover"in b&&"onmspointerout"in b; this.touchStart=this.W3CTouch?"touchstart":this.isMSTouch?"MSPointerDown":"mousedown";this.touchEnd=this.W3CTouch?"touchend":this.isMSTouch?"MSPointerUp":"mouseup";this.touchMove=this.W3CTouch?"touchmove":this.isMSTouch?"MSPointerMove":"mousemove"}).run(["swipePanelConfigs","nano_swipePanelConst","nano_allPanels","panelActions",function(g,f,e,d){function c(){a.coordsX.min=Math.min.apply(null,a.touchesX);a.coordsX.max=Math.max.apply(null,a.touchesX);a.coordsY.min=Math.min.apply(null,a.touchesY);a.coordsY.max= Math.max.apply(null,a.touchesY);var c=a.coordsX.max-a.coordsX.min,e=a.coordsY.max-a.coordsY.min;e>=b.innerHeight/100*g.YIgnoreDistance||e>c||5>a.touchesX.length&&c<b.innerWidth/100*g.XRegisterDistance||(c=a.touchesX[0]<a.touchesX[a.touchesX.length-1],a.direction=c?"right":"left",a.oppositeDirection=c?"left":"right")}var a={touchesX:[],touchesY:[],coordsX:{min:0,max:0},coordsY:{min:0,max:0},direction:"",diff:0,oppositeDirection:""},k={touchStart:function(c){a.touchesX.push(f.W3CTouch?c.touches[0].screenX: c.clientX);a.touchesY.push(b.scrollY);b.addEventListener(f.touchMove,k.touchMove,!1)},touchEnd:function(d){b.removeEventListener(f.touchMove,k.touchMove);a.touchesX.push(f.W3CTouch?d.changedTouches[0].screenX:d.clientX);a.touchesY.push(b.scrollY);""===a.direction&&c();if(""!==a.direction)if(e[a.direction].isOpen)e[a.direction].close();else e[a.oppositeDirection][a.coordsX.max-a.coordsX.min>=g.toggleDistance?"open":"close"]();a.touchesX.length=0;a.coordsX.min=0;a.coordsX.max=0;a.touchesY.length=0; a.coordsY.min=0;a.coordsY.max=0;a.direction="";a.oppositeDirection=""},touchMove:function(d){var h=f.W3CTouch?d.touches[0].screenX:d.clientX;a.touchesX.length<2*g.XRegisterDistance&&(a.touchesX.push(h),a.touchesY.push(b.scrollY));a.touchesX.length<g.XRegisterDistance||(a.touchesX.length===g.XRegisterDistance&&c(),""===a.direction||e[a.direction].isOpen||(e[a.oppositeDirection].newX="left"===a.oppositeDirection?h-b.innerWidth/100*g.panelWidth-e[a.oppositeDirection].parentMargin:h-e[a.oppositeDirection].parentMargin, h="left"===a.direction&&0>=e[a.oppositeDirection].newX+e[a.oppositeDirection].parentMargin-b.innerWidth/100*(100-g.panelWidth),h="right"===a.direction&&0<=e[a.oppositeDirection].newX+e[a.oppositeDirection].parentMargin||h?!0:!1,h||(d.preventDefault(),d={"transition-duration":"0s"},d[e[a.oppositeDirection].cssProps.transform]="translate3d("+e[a.oppositeDirection].newX+"px, 0px,0px)",e[a.oppositeDirection].element.css(d))))}};g.swipeOpen&&(b.addEventListener(f.touchStart,k.touchStart,!1),b.addEventListener(f.touchEnd, k.touchEnd,!1));b.addEventListener("resize",d.resize,!1)}]).factory("panelActions",["nano_allPanels","$rootScope",function(b,f){function e(c){return"string"===typeof c&&"undefined"!==typeof b[c]}var d={resize:function(){for(var c in b)b[c].resize()},toggle:function(c){if("string"===typeof c&&"undefined"!==typeof b[c])return b[c].toggle();for(var a in b)if(b[a].isOpen)return b[a].toggle();return!1},open:function(c){return e(c)||b[c].isOpen?b[c].open():!1},close:function(c){return!e(c)&&b[c].isOpen? !1:b[c].close()}};return f.panelActions=d}]).factory("nano_panelCreator",["swipePanelConfigs",function(g){return function(f,e){this.position=e;this.element=f;this.isOpen=!1;this.parentMargin=(b.innerWidth-this.element.parent()[0].offsetWidth)/2;this.resize=function(){this.width=b.innerWidth/100*g.panelWidth;this.startX=("left"===this.position?0-this.width:b.innerWidth)-this.parentMargin;this.stopX=("left"===this.position?0:b.innerWidth/100*(100-g.panelWidth))-this.parentMargin;this.element.css({width:this.width+ "px","transition-duration":"0s"})};this.resize();var d=b.document.body.style;this.cssProps="MozTransition"in d&&"MozTransform"in d?{domTransition:"MozTransition",transition:"-moz-transition",transform:"-moz-transform",domTransform:"MozTransform",radialGradient:"-moz-radial-gradient",repeatingLinearGradient:"-moz-repeating-linear-gradient",translate3d:"translate3d",userSelect:"-moz-user-select"}:"WebkitTransition"in d&&"WebkitTransform"in d?{domTransition:"WebkitTransition",transition:"-webkit-transition", transform:"-webkit-transform",domTransform:"WebkitTransform",radialGradient:"-webkit-radial-gradient",repeatingLinearGradient:"-webkit-repeating-linear-gradient",translate3d:"translate3d",userSelect:"-webkit-user-select"}:"msTransition"in d&&"msTransform"in d?{domTransition:"msTransition",transition:"-ms-transition",transform:"-ms-transform",domTransform:"msTransform",radialGradient:"-ms-radial-gradient",repeatingLinearGradient:"-ms-repeating-linear-gradient",translate3d:"translate3d",userSelect:"-ms-user-select"}: {domTransition:"transition",transition:"transition",transform:"transform",domTransform:"transform",radialGradient:"radial-gradient",repeatingLinearGradient:"repeating-linear-gradient",translate3d:"translate3d",userSelect:"user-select"};this.toggle=function(){this[this.isOpen?"close":"open"]()};this.open=function(){this.isOpen=!0;var b={"transition-duration":"0.3s"};b[this.cssProps.transform]="translate3d("+this.stopX+"px, 0px,0px)";this.element.css(b)};this.close=function(){this.isOpen=!1;var b={"transition-duration":"0.3s"}; b[this.cssProps.transform]="translate3d("+this.startX+"px, 0px,0px)";this.element.css(b)};this.element.parent().css({width:b.innerWidth+"px"});d={position:"fixed",top:"0px","z-index":"9999",width:this.width+"px",height:"150%","transition-timing-function":"ease-in-out"};d[this.cssProps.transform]="translate3d("+this.startX+"px, 0px,0px)";this.element.css(d)}}]).directive("ngSwipePanel",["nano_panelCreator","nano_allPanels",function(b,f){return{compile:function(e,d){var c=d.ngSwipePanel;"undefined"=== typeof f[c]&&(f[c]=new b(e,c))}}}])})(window);