/*
 angular-swipe-panel v0.1
 (c) 2014 Tim RÃ¼cker
 License: Apache License
*/
(function(c){c.angular.module("angular-swipe-panel",[]).factory("nano_allPanels",function(){return{}}).factory("swipePanelConfigs",[function(){return{XRegisterDistance:25,YIgnoreDistance:8,panelWidth:80,toggleDistance:75,swipeOpen:!1}}]).constant("nano_swipePanelConst",new function(){this.W3CTouch="ontouchstart"in c&&"ontouchmove"in c&&"ontouchend"in c&&"ontouchcancel"in c;this.isMSTouch="onmspointerdown"in c&&"onmspointermove"in c&&"onmspointerup"in c&&"onmspointerover"in c&&"onmspointerout"in c;
    this.touchStart=this.W3CTouch?"touchstart":this.isMSTouch?"MSPointerDown":"mousedown";this.touchEnd=this.W3CTouch?"touchend":this.isMSTouch?"MSPointerUp":"mouseup";this.touchMove=this.W3CTouch?"touchmove":this.isMSTouch?"MSPointerMove":"mousemove"}).run(["swipePanelConfigs","nano_swipePanelConst","nano_allPanels","panelActions",function(d,g,f,e){function b(){a.coordsX.min=Math.min.apply(null,a.touchesX);a.coordsX.max=Math.max.apply(null,a.touchesX);a.coordsY.min=Math.min.apply(null,a.touchesY);a.coordsY.max=
    Math.max.apply(null,a.touchesY);var b=a.coordsX.max-a.coordsX.min,f=a.coordsY.max-a.coordsY.min;f>=c.innerHeight/100*d.YIgnoreDistance||f>b||5>a.touchesX.length&&b<c.innerWidth/100*d.XRegisterDistance||(b=a.touchesX[0]<a.touchesX[a.touchesX.length-1],a.direction=b?"right":"left",a.oppositeDirection=b?"left":"right")}var a={touchesX:[],touchesY:[],coordsX:{min:0,max:0},coordsY:{min:0,max:0},direction:"",diff:0,oppositeDirection:""},k={touchStart:function(b){a.touchesX.push(g.W3CTouch?b.touches[0].screenX:
    b.clientX);a.touchesY.push(c.scrollY);c.addEventListener(g.touchMove,k.touchMove,!1)},touchEnd:function(e){c.removeEventListener(g.touchMove,k.touchMove);a.touchesX.push(g.W3CTouch?e.changedTouches[0].screenX:e.clientX);a.touchesY.push(c.scrollY);""===a.direction&&b();if(""!==a.direction)if(f[a.direction].isOpen)f[a.direction].close();else f[a.oppositeDirection][a.coordsX.max-a.coordsX.min>=d.toggleDistance?"open":"close"]();a.touchesX.length=0;a.coordsX.min=0;a.coordsX.max=0;a.touchesY.length=0;
    a.coordsY.min=0;a.coordsY.max=0;a.direction="";a.oppositeDirection=""},touchMove:function(e){var h=g.W3CTouch?e.touches[0].screenX:e.clientX;a.touchesX.length<2*d.XRegisterDistance&&(a.touchesX.push(h),a.touchesY.push(c.scrollY));a.touchesX.length<d.XRegisterDistance||(a.touchesX.length===d.XRegisterDistance&&b(),""===a.direction||f[a.direction].isOpen||(f[a.oppositeDirection].newX="left"===a.oppositeDirection?h-c.innerWidth/100*d.panelWidth-f[a.oppositeDirection].parentMargin:h-f[a.oppositeDirection].parentMargin,
    h="left"===a.direction&&0>=f[a.oppositeDirection].newX+f[a.oppositeDirection].parentMargin-c.innerWidth/100*(100-d.panelWidth),h="right"===a.direction&&0<=f[a.oppositeDirection].newX+f[a.oppositeDirection].parentMargin||h?!0:!1,h||(e.preventDefault(),e={"transition-duration":"0s"},e[f[a.oppositeDirection].cssProps.transform]="translate3d("+f[a.oppositeDirection].newX+"px, 0px,0px)",f[a.oppositeDirection].element.css(e))))}};d.swipeOpen&&(c.addEventListener(g.touchStart,k.touchStart,!1),c.addEventListener(g.touchEnd,
    k.touchEnd,!1));c.addEventListener("resize",e.resize,!1)}]).factory("panelActions",["nano_allPanels","$rootScope",function(d,c){function f(b){return"string"===typeof b&&"undefined"!==typeof d[b]}var e={resize:function(){for(var b in d)d[b].resize&&d[b].resize()},toggle:function(b){d.hider.css("display","none");if("string"===typeof b&&"undefined"!==typeof d[b])return d[b].toggle();for(var a in d)if(d[a].isOpen)return d[a].toggle();return!1},open:function(b){if(!f(b)&&!d[b].isOpen)return!1;d.hider.css("display",
    "block");return d[b].open()},close:function(b){if(!f(b)&&d[b].isOpen)return!1;d.hider.css("display","none");return d[b].close()}};return c.panelActions=e}]).factory("nano_panelCreator",["swipePanelConfigs",function(d){return function(g,f){this.position=f;this.element=g;this.isOpen=!1;this.parentMargin=(c.innerWidth-this.element.parent()[0].offsetWidth)/2;this.resize=function(){this.width=c.innerWidth/100*d.panelWidth;this.startX=("left"===this.position?0-this.width:c.innerWidth)-this.parentMargin;
    this.stopX=("left"===this.position?0:c.innerWidth/100*(100-d.panelWidth))-this.parentMargin;this.element.css({width:this.width+"px","transition-duration":"0s"})};this.resize();var e=c.document.body.style;this.cssProps="MozTransition"in e&&"MozTransform"in e?{domTransition:"MozTransition",transition:"-moz-transition",transform:"-moz-transform",domTransform:"MozTransform",radialGradient:"-moz-radial-gradient",repeatingLinearGradient:"-moz-repeating-linear-gradient",translate3d:"translate3d",userSelect:"-moz-user-select"}:
    "WebkitTransition"in e&&"WebkitTransform"in e?{domTransition:"WebkitTransition",transition:"-webkit-transition",transform:"-webkit-transform",domTransform:"WebkitTransform",radialGradient:"-webkit-radial-gradient",repeatingLinearGradient:"-webkit-repeating-linear-gradient",translate3d:"translate3d",userSelect:"-webkit-user-select"}:"msTransition"in e&&"msTransform"in e?{domTransition:"msTransition",transition:"-ms-transition",transform:"-ms-transform",domTransform:"msTransform",radialGradient:"-ms-radial-gradient",
        repeatingLinearGradient:"-ms-repeating-linear-gradient",translate3d:"translate3d",userSelect:"-ms-user-select"}:{domTransition:"transition",transition:"transition",transform:"transform",domTransform:"transform",radialGradient:"radial-gradient",repeatingLinearGradient:"repeating-linear-gradient",translate3d:"translate3d",userSelect:"user-select"};this.toggle=function(){this[this.isOpen?"close":"open"]()};this.open=function(){this.isOpen=!0;var b={"transition-duration":"0.3s"};b[this.cssProps.transform]=
    "translate3d("+this.stopX+"px, 0px,0px)";this.element.css(b)};this.close=function(){this.isOpen=!1;var b={"transition-duration":"0.3s"};b[this.cssProps.transform]="translate3d("+this.startX+"px, 0px,0px)";this.element.css(b)};this.element.parent().css({width:c.innerWidth+"px"});e={position:"fixed",top:"0px","z-index":"9999",width:this.width+"px",height:"150%","transition-timing-function":"ease-in-out"};e[this.cssProps.transform]="translate3d("+this.startX+"px, 0px,0px)";this.element.css(e)}}]).directive("ngSwipePanel",
    ["nano_panelCreator","nano_allPanels",function(d,c){return{compile:function(f,e){var b=e.ngSwipePanel;"undefined"===typeof c[b]&&(c[b]=new d(f,b))}}}]).directive("ngSwipePanelHider",["$rootScope","nano_allPanels","panelActions",function(c,g,f){return{compile:function(e){e.css({display:"none",width:"100%",height:"100%",position:"fixed","z-index":9998});g.hider=e;e.on("click",function(){c.$apply(function(){f.toggle()})})}}}])})(window);